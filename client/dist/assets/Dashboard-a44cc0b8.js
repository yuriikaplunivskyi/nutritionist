import{r as p,j as e,_ as v,a as f,L as x,b as C}from"./index-cc2c0e53.js";import{a as g}from"./axios-d16e7a2c.js";import{u as b}from"./useServiceData-7665bea7.js";import{A as S}from"./Accordions-95deae46.js";import N from"./UpdateService-01f3935e.js";const y=()=>{const l={title:"",descr:"",path:"",passing:[],prices:[],warnings:[],icon:""},[n,d]=p.useState(l),o=s=>{const{name:t,value:a}=s.target;d(c=>({...c,[t]:a}))},h=(s,t,a,c)=>{const u=[...n[c]];u[s][t]=a,d({...n,[c]:u})},m=(s,t)=>{d({...n,[s]:[...n[s],t]})},r=(s,t)=>{const a=[...n[t]];a.splice(s,1),d({...n,[t]:a})},i=async s=>{s.preventDefault();try{await g.post(".location.origin}/api/services",n),d(l)}catch(t){console.log(t)}};return e.jsx("div",{className:"formAddServices",children:e.jsxs("div",{className:"container",children:[e.jsx("h6",{children:"Додай нову послугу"}),e.jsx("input",{type:"text",name:"title",value:n.title,onChange:o,placeholder:"Назва послуги"}),e.jsx("textarea",{cols:"30",rows:"10",value:n.descr,name:"descr",onChange:o,placeholder:"Опис послуги"}),e.jsx("input",{type:"text",name:"path",value:n.path,onChange:o,placeholder:"Шлях до послуги"}),e.jsxs("div",{children:[e.jsx("h6",{children:"Passing"}),n.passing.map((s,t)=>e.jsxs("div",{children:[e.jsx("input",{type:"text",value:s.stage,onChange:a=>h(t,"stage",a.target.value,"passing"),placeholder:`Passing ${t+1}`}),e.jsx("button",{className:"formAddServices-delete btn",onClick:()=>r(t,"passing"),children:"Видалити"})]},t)),e.jsx("button",{className:"formAddServices-add btn",onClick:()=>m("passing",{stage:"",id:n.passing.length+1}),children:"Додати Passing"})]}),e.jsxs("div",{children:[e.jsx("h6",{children:"Prices"}),n.prices.map((s,t)=>e.jsxs("div",{children:[e.jsx("input",{type:"text",value:s.price,onChange:a=>h(t,"price",a.target.value,"prices"),placeholder:`Prices ${t+1}`}),e.jsx("button",{className:"formAddServices-delete btn",onClick:()=>r(t,"prices"),children:"Видалити"})]},t)),e.jsx("button",{className:"formAddServices-add btn",onClick:()=>m("prices",{price:"",id:n.prices.length+1}),children:"Додати Prices"})]}),e.jsxs("div",{children:[e.jsx("h6",{children:"Warnings"}),n.warnings.map((s,t)=>e.jsxs("div",{children:[e.jsx("input",{type:"text",value:s.title,onChange:a=>h(t,"title",a.target.value,"warnings"),placeholder:`Title ${t+1}`}),e.jsx("input",{type:"text",value:s.content,onChange:a=>h(t,"content",a.target.value,"warnings"),placeholder:`Content ${t+1}`}),e.jsx("button",{className:"formAddServices-delete btn",onClick:()=>r(t,"warnings"),children:"Видалити"})]},t)),e.jsx("button",{className:"formAddServices-add btn",onClick:()=>m("warnings",{title:"",content:"",id:n.warnings.length+1}),children:"Додати Warnings"})]}),e.jsx("button",{className:"formAddServices-send btn",onClick:i,children:"Відправити на сервер"})]})})};const A=()=>{const{serviceData:l}=b(),[n,d]=p.useState(null),[o,h]=p.useState(l);p.useEffect(()=>{h(l)},[l]);const m=async i=>{try{console.log(i),await g.delete(`.location.origin}/api/services/${i}`),h(s=>s.filter(t=>t.id!==i))}catch(s){console.log("What the error",s)}},r=i=>{d(i)};return e.jsx(e.Fragment,{children:n?e.jsx(N,{serviceId:n,setSelectedServiceId:d}):o.map(i=>e.jsxs("div",{className:"serviceAdmin",children:[e.jsxs("div",{className:"service-container",children:[e.jsxs("div",{className:"service-textContainer",children:[e.jsx("h2",{className:"service-title",children:i.title}),e.jsx("p",{className:"service-text",children:i.descr}),e.jsxs("ol",{children:[e.jsx("span",{children:"Як проходить"}),i.passing.map(s=>e.jsx("li",{children:s.stage},s.id))]}),e.jsxs("ul",{children:[e.jsx("span",{className:"service-price-title",children:" Вартість: "}),i.prices.map(s=>e.jsx("li",{className:"service-price",children:s.price},s.id))]})]}),e.jsx(S,{data:i.warnings}),e.jsx("span",{children:i.path})]}),e.jsxs("div",{className:"serviceAdmin-btnWrapper",children:[e.jsx("button",{className:"serviceAdmin-delete btn",onClick:()=>m(i.id),children:"Видалити"}),e.jsx("button",{className:"serviceAdmin-change btn",onClick:()=>r(i.id),children:"Змінити"})]})]},i.id))})};const _=()=>{const l={school:"",title:"",img_path:""},[n,d]=p.useState(null),[o,h]=p.useState(l),m=t=>{const{name:a,value:c}=t.target;h(u=>({...u,[a]:c}))},r=t=>{const a=t.target.files[0];d(a)},i=t=>{t.preventDefault();const a=t.dataTransfer.files[0];d(a)},s=async t=>{t.preventDefault();try{const a=new FormData;a.append("certificateImage",n),a.append("school",o.school),a.append("title",o.title);const c=await g.post(".location.origin}/api/uploadCertificate",a,{headers:{"Content-Type":"multipart/form-data"}});h(u=>({...u,img_path:c.data.file})),console.log(c.data),h(l),d(new File([],""))}catch(a){console.error("Error uploading certificate:",a)}};return e.jsx("div",{className:"addCertificateForm",children:e.jsxs("div",{className:"container",children:[e.jsx("h6",{children:"Додати сертифікат"}),e.jsxs("form",{onSubmit:s,children:[e.jsx("label",{children:"Організація/школа:"}),e.jsx("input",{type:"text",name:"school",value:o.school,onChange:m,required:!0}),e.jsx("label",{children:"Назва програми:"}),e.jsx("input",{type:"text",name:"title",value:o.title,onChange:m,required:!0}),e.jsxs("div",{className:"addCertificateForm__wrapper",children:[e.jsx("label",{children:"Перетягни чи вибери зображення сертифіката"}),e.jsx("input",{className:"addCertificateForm__inputFile",type:"file",onChange:r,onDrop:i,accept:"image/*"})]}),e.jsx("button",{className:"btn btn-add",type:"submit",children:"Відпраити дані"})]}),o.img_path&&e.jsx("img",{src:o.img_path,alt:"Certificate Preview"})]})})};const w=({certificateId:l,setSelectedCertificateId:n})=>{const d={title:"",school:"",img_path:""},[o,h]=p.useState(d),[m,r]=p.useState(null),i=a=>{const{name:c,value:u}=a.target;h(j=>({...j,[c]:u}))},s=a=>{const c=a.target.files[0];r(c)};p.useEffect(()=>{(async()=>{try{const c=await g.get(`.location.origin}/api/certificates/${l}`);h(c.data)}catch(c){c.response&&c.response.status===404?console.log(`Certificate with ID ${l} not found`):console.error("Error fetching certificate:",c)}})()},[l]);const t=async a=>{a.preventDefault();try{const c=new FormData;c.append("school",o.school),c.append("title",o.title),m&&c.append("certificateImage",m),await g.put(`.location.origin}/api/certificates/${l}`,c,{headers:{"Content-Type":"multipart/form-data"}}),n(null),h(d)}catch(c){console.log(c)}};return e.jsxs("form",{className:"updateCerfForm",onSubmit:t,children:[e.jsx("h6",{children:"Змінити сертифікат"}),e.jsx("input",{type:"text",name:"title",value:o.title,onChange:i,placeholder:"Назва сертифіката"}),e.jsx("input",{type:"text",name:"school",value:o.school,onChange:i,placeholder:"Назва школи"}),e.jsx("input",{type:"file",name:"img_path",accept:"image/*",onChange:s}),e.jsx("img",{src:`http://localhost:8800/public/${o.img_path}`,alt:"Certificate Preview",style:{maxWidth:"300px",maxHeight:"200px"}}),e.jsx("button",{className:"send btn",children:"Внести зміни"})]})},D=()=>{const[l,n]=p.useState(""),[d,o]=p.useState(null);p.useEffect(()=>{(async()=>{try{const i=await g.get(".location.origin}/api/certificates");n(i.data)}catch(i){console.log(i),console.error("Error fetching certificate data:",i),n("")}})()},[]);const h=async r=>{try{console.log(r),await g.delete(`.location.origin}/api/certificates/${r}`),n(i=>i.filter(s=>s.id!==r))}catch(i){console.log("What the error",i)}},m=r=>{o(r)};return e.jsx(e.Fragment,{children:d?e.jsx(w,{certificateId:d,setSelectedCertificateId:o}):Array.isArray(l)&&l.map(r=>e.jsxs("div",{className:"certificate",children:[e.jsxs("div",{className:"certificate__content",children:[e.jsx("h5",{children:r.title}),e.jsx("span",{children:r.school}),e.jsx("img",{src:`http://localhost:8800/public/${r.img_path}`,alt:r.img_path})]}),e.jsxs("div",{className:"certificate__btns",children:[e.jsx("button",{className:"certificate-delete btn",onClick:()=>h(r.id),children:"Видалити"}),e.jsx("button",{className:"certificate-change btn",onClick:()=>m(r.id),children:"Змінити"})]})]},r.id))})},F=p.lazy(()=>v(()=>import("./Navbar-c195de69.js"),["./Navbar-c195de69.js","./index-cc2c0e53.js","./index-59da6e9c.css","./motion-24ad9811.js","./Navbar-32d2ba6e.css"],import.meta.url)),L=()=>{const[l,n]=p.useState("");return e.jsx("div",{className:"dashboard",children:e.jsxs(p.Suspense,{fallback:e.jsx("div",{className:"loader-container",children:e.jsx(f,{})}),children:[e.jsx(F,{}),e.jsxs("div",{className:"dashboard_nav",children:[e.jsx(x,{className:"btn",to:"/",children:"Повернутися на головну"}),e.jsx(x,{className:"btn",to:"/admin/reset",children:"Скидування паролю"}),e.jsx(x,{className:"btn",to:"/admin/signup",children:"Зареєструватися"}),e.jsx("button",{className:"btn",onClick:C.logout,children:"Вийти з аккаунту"})]}),e.jsxs("div",{className:"dashboard__window",children:[e.jsxs("div",{className:"dashboard_tabs",children:[e.jsx("button",{className:"btn",onClick:()=>n("changeServices"),children:"Змінити доступні послуги"}),e.jsx("button",{className:"btn",onClick:()=>n("addServices"),children:"Додати нову послугу"}),e.jsx("button",{className:"btn",onClick:()=>n("changeCertificate"),children:"Змінити доступні сертифікати"}),e.jsx("button",{className:"btn",onClick:()=>n("addCertificate"),children:"Додати новий сертифікат"})]}),e.jsxs("div",{className:"dashboard__content",children:[l==="changeServices"&&e.jsx(A,{}),l==="changeCertificate"&&e.jsx(D,{}),l==="addServices"&&e.jsx(y,{}),l==="addCertificate"&&e.jsx(_,{})]})]})]})})};export{F as LazyNavbar,L as default};
